---
katex: true
---

# 以太网

以太网是现实世界中最普遍的一种计算机网络，主要分为两类，即**经典以太网**和**交换式以太网**。前者是以太网较为原始的形式，运行速度为 $3 \sim 10 \text{Mb/s}$，后者可运行在更高的速率上。

## 经典以太网

### 物理层

经典以太网采用**同轴电缆**作为物理传输介质，以**总线型**拓扑结构连接计算机。电缆有最大长度限制，信号在限制范围内可以正常传播，超出范围需要使用**中继器**连接。以太网的物理层采用**曼彻斯特编码**进行信息发送。

### MAC 子层协议

经典以太网的帧格式有两种：一种是 DIX 格式，另一种是 IEEE 802.3 格式。

=== "DIX"

    ```mermaid
    ---
    title: "Ethernet-DIX"
    ---
    packet-beta
        0-7: "Preamble"
        8-13: "Destination Address"
        14-19: "Source Address"
        20-21: "Type"
        22-24: "Data: 0 ~ 1500"
        25-27: "Pad: 0 ~ 46"
        28-31: "CRC"
    ```

=== "IEEE 802.3"

    ```mermaid
    ---
    title: "Ethernet-IEEE 802.3"
    ---
    packet-beta
        0-6: "Preamble"
        7-7: "SOF"
        8-13: "Destination Address"
        14-19: "Source Address"
        20-21: "Length"
        22-24: "Data: 0 ~ 1500"
        25-27: "Pad: 0 ~ 46"
        28-31: "CRC"
    ```

首先是 8 字节的前导码，每字节包含位模式 `10101010`（除最后一字节最后两位为 `11`）。这最后一字节称为 IEEE 802.3 的帧**起始定界符**，起到时钟同步的作用。

接下来是两个地址，前者为目标地址，后者为源地址，长度均为 6 字节。目标地址的第一位如果是 `0`，说明改地址是一个**普通地址**；如果是 `1`，说明该地址为一个**组地址**。如果目标地址是组地址，则该组中的所有站都要接收它，这种方式称为**组播**。若目标地址为**全** `1` 的特殊地址，则该帧被**广播**，它被网络上所有的站接收。

再接下来是类型或长度字段，取决于采用 DIX 协议还是 IEEE 802.3 协议。前者告诉接收方帧内包含了什么，该交由哪个进程处理。后者交代了携带帧的长度，由之后的 LLC 层来处理协议类型信息。

数据块的长度被限制在 $0 \sim 1500$ 字节，最长限制是因为内存有限。之后的填充部分是为了保证**最小帧长**的限制。

以太网使用 **CSMA/CD 协议**实现介质访问控制，因此为确保能够[成功检测到冲突](./ChannelAllocationProtocol.md/#csma)，需要 $2\tau$ 的帧传播时间。再由信道传播速率可得最小帧长为 64 字节。因此需要保证数据和填充加起来不小于 46 字节。

最后一个字段是校验和，采用 32 位的 [CRC 校验](./ErrorDetectionAndCorrection.md/#_10)。

!!! note "以太网的 CSMA/CD"
    以太网采用 CSMA/CD 进行介质访问控制。若发生冲突，需要等待随机时间，这个随机时间的长度遵循**二进制指数退避算法**。

## 交换式以太网

交换式以太网利用**交换机**实现了冲突域的隔离，从而提高了网络性能。

### 快速以太网

| 名称 | 线缆 | 最大长度/m | 优点 |
|: --- :|: --- :|: --- :|: --- :|
| 100 Base-T4 | 双绞线 | 100 | 可用 3 类 UTP |
| 100 Base-TX | 双绞线 | 100 | 全双工速率 100Mb/s（5 类 UTP） |
| 100 Base-FX | 双绞线 | 2000 | 全双工速率 100Mb/s，距离长 |

### 千兆以太网

| 名称 | 线缆 | 最大长度/m | 优点 |
|: --- :|: --- :|: --- :|: --- :|
| 1000 Base-SX | 光纤 | 550 | 多模光纤（$50 \mu$m、$62.5 \mu$m） |
| 1000 Base-LX | 光纤 | 5000 | 单模光纤（$10 \mu$m）或多模光纤（$50 \mu$m、$62.5 \mu$m） |
| 1000 Base-CX | 两对 STP | 25 | 屏蔽双绞线 |
| 1000 Base-T | 两对 UTP | 100 | 标准 5 类 UTP |

### 万兆以太网

| 名称 | 线缆 | 最大长度 | 优点 |
|: --- :|: --- :|: --- :|: --- :|
| 10G Base-SR | 光纤 | 最多 300 m | 多模光纤（$0.8 \mu$m） |
| 10G Base-LR | 光纤 | 10 km | 单模光纤（$1.3 \mu$m） |
| 10G Base-ER | 光纤 | 40 km | 单模光纤（$1.5 \mu$m） |
| 10G Base-CX4 | 4 对双轴铜缆 | 15 m | 双轴铜缆 |
| 10G Base-T | 4 对 UTP | 100 m | 6a 类 UTP |